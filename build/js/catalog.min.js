const constMonth=[31,28,31,30,31,30,31,31,30,31,30,31],constWeek=["пн","вт","ср","чт","пт","сб","вс"],constNameOfMonth=["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"];class Calendar{constructor(e,t){this.$el=document.querySelector(e),this.data=t;let a=new Date;this.year=a.getFullYear(),this.month=a.getMonth(),this.selectedValue=[],this.daysArray,this.#e(),this.#t(),this.#a()}#e(){this.$el.querySelector(".datapicker").innerHTML=calenderTemplate()}#t(){this.$el.querySelector(".datapicker__title").innerText=`${constNameOfMonth[this.month]??""} ${this.year??""}`,this.daysArray=this.#s(),this.$el.querySelector(".gridbody__web").innerHTML=this.daysArray.map((e=>{let t=new Date(1e3*e.value),a="";return e.value==this.selectedValue[0]&&"gridbody__day"==e.style&&(a="gridbody__day-select"),this.selectedValue[1]&&e.value==this.selectedValue[1]&&"gridbody__day"==e.style&&(a="gridbody__day-select"),`\n\t\t\t<div class="gridbody__cell ${a} ${e.style}" data-value="${e.value}">${t.getDate()}</div>\n\t\t\t`})).join(""),this.selectedValue[1]&&this.#l(this.selectedValue[0],this.selectedValue[1],!0,!0)}#a(){this.buttonClickHandler=this.buttonClickHandler.bind(this),this.$el.addEventListener("click",this.buttonClickHandler),this.buttonHoverHandler=this.buttonHoverHandler.bind(this)}#s(){let e=[],t=new Date(this.year,this.month,1),a=getHumanDay(t.getDay());for(let s=a+1;s>1;s--)e.push({value:Math.floor(t/1e3)-86400*(s-1),style:"gridbody__prev"});let s=constMonth[this.month];1==this.month&&this.year%4==0&&s++;for(let a=0;a<s;a++)e.push({value:Math.floor(t/1e3)+86400*a,style:"gridbody__day"});t=new Date(this.year,this.month,s),a=getHumanDay(t.getDay());let l=1;if(6!=a)for(let s=a+1;s<7;s++)e.push({value:Math.floor(t/1e3)+86400*l,style:"gridbody__next"}),l++;return e}buttonClickHandler(e){return e.target.closest(".datapicker__next")||e.target.closest(".gridbody__next")?(e.preventDefault(),11==this.month?(this.month=0,this.year++):this.month++,void this.#t()):e.target.closest(".datapicker__prev")||e.target.closest(".gridbody__prev")?(e.preventDefault(),0==this.month?(this.month=11,this.year--):this.month--,void this.#t()):e.target.closest(".gridbody__day")?this.selectedValue[1]?(this.selectedValue=[],this.#t(),void this.#i()):void(this.selectedValue[0]?(this.$el.removeEventListener("mouseover",this.buttonHoverHandler),this.selectedValue[1]=e.target.dataset.value,e.target.classList.add("gridbody__day-select"),this.selectedValue=this.selectedValue.sort(),this.#i(),this.#r(),this.#l(this.selectedValue[0],this.selectedValue[1],!0,!0)):(this.$el.addEventListener("mouseover",this.buttonHoverHandler),this.selectedValue[0]=e.target.dataset.value,this.#i(),this.#r(),e.target.classList.add("gridbody__day-select"))):e.target.closest(".datapicker__clear")?(e.preventDefault(),this.selectedValue=[],this.#t(),void this.#i()):e.target.closest(".datapicker__submit")?(e.preventDefault(),this.$el.querySelectorAll(".card__input").forEach((e=>e.classList.remove("show"))),void this.$el.querySelector(".datapicker").classList.remove("show")):void(e.target.closest(".card__input")&&(this.$el.querySelectorAll(".card__input").forEach((e=>e.classList.toggle("show"))),this.$el.querySelector(".datapicker").classList.toggle("show")))}buttonHoverHandler(e){if(!e.target.closest(".gridbody__day"))return e.target.closest(".gridbody__prev")?(this.#r(),void this.#l(this.daysArray[0].value,this.selectedValue[0],!1,!0)):e.target.closest(".gridbody__next")?(this.#r(),void this.#l(this.selectedValue[0],this.daysArray.at(-1).value,!0,!1)):void 0;{this.#r();let t=e.target.dataset.value;switch(!0){case t<this.selectedValue[0]:this.#r(),this.#l(t,this.selectedValue[0],!1,!0);break;case t>this.selectedValue[0]:this.#r(),this.#l(this.selectedValue[0],t,!0,!1);break;case t==this.selectedValue[0]:this.#r()}}}#r(){this.$el.querySelectorAll(".gridbody__day").forEach((e=>{e.classList.contains("gridbody__day-hover")&&e.classList.remove("gridbody__day-hover"),e.classList.contains("gridbody__day-selectleft")&&e.classList.remove("gridbody__day-selectleft"),e.classList.contains("gridbody__day-selectright")&&e.classList.remove("gridbody__day-selectright")}))}#l(e,t,a,s){this.$el.querySelectorAll(".gridbody__day").forEach((l=>{let i=l.dataset.value;if(e!=t||l.dataset.value!=e)switch(!0){case a&&i==e:l.classList.add("gridbody__day-selectleft");break;case s&&i==t:l.classList.add("gridbody__day-selectright");break;case e<=i&&t>=i:l.classList.add("gridbody__day-hover")}else l.classList.add("gridbody__day-select")}))}#i(){const e=this.$el.querySelectorAll(`${this.data.class}`);switch(e.length){case 1:switch(this.selectedValue.length){case 1:e[0].innerHTML=`${getTimeFromUnixtime(this.selectedValue[0])}-`;break;case 2:e[0].innerHTML=`${getTimeFromUnixtime(this.selectedValue[0])}-${getTimeFromUnixtime(this.selectedValue[1])}`;break;default:e[0].innerHTML=`${this.data.placeholder}-${this.data.placeholder}`}break;case 2:switch(this.selectedValue.length){case 1:e[0].innerHTML=`${getTimeFromUnixtime(this.selectedValue[0])}`,e[1].innerHTML=`${this.data.placeholder}`;break;case 2:e[0].innerHTML=`${getTimeFromUnixtime(this.selectedValue[0])}`,e[1].innerHTML=`${getTimeFromUnixtime(this.selectedValue[1])}`;break;default:e[0].innerHTML=`${this.data.placeholder}`,e[1].innerHTML=`${this.data.placeholder}`}}}}const getHumanDay=e=>(--e<0&&(e=6),e),calenderTemplate=()=>'\n\t<div class="datapicker__header">\n\t\t<div class="datapicker__btns">\n\t\t\t<a href="#" class="datapicker__btn datapicker__prev">\n\t\t\t</a>\n\t\t</div>\n\t\t<div class="datapicker__title">\n\n\t\t</div>\n\t\t<div class="datapicker__btns">\n\t\t\t<a href="#" class="datapicker__btn datapicker__next">\n\t\t\t</a>\n\t\t</div>\n\t</div>\n\n\t\n\t<div class="datapicker__body gridbody">\n\t\t<div class="gridbody__row">\n\t\t\t<div class="gridbody__cell gridbody__cellname">Пн</div>\n\t\t\t<div class="gridbody__cell gridbody__cellname">Вт</div>\n\t\t\t<div class="gridbody__cell gridbody__cellname">Ср</div>\n\t\t\t<div class="gridbody__cell gridbody__cellname">Чт</div>\n\t\t\t<div class="gridbody__cell gridbody__cellname">Пт</div>\n\t\t\t<div class="gridbody__cell gridbody__cellname">Сб</div>\n\t\t\t<div class="gridbody__cell gridbody__cellname">Вс</div>\n\t\t</div>\n\t\t<div class="gridbody__row gridbody__web">\n\n\t\t</div>\n\t</div>\n\n\t<div class="datapicker__footer">\n\t\t<div class="datapicker__btns">\n\t\t\t<a href="#" class="datapicker__btn datapicker__clear">\n\t\t\t\tочистить\n\t\t\t</a>\n\t\t\t<a href="#" class="datapicker__btn datapicker__submit">\n\t\t\t\tприменить\n\t\t\t</a>\n\t\t</div>\n\t</div>\n\t',getTimeFromUnixtime=e=>{const t=new Date(1e3*e);let a=t.getDate(),s=t.getMonth()+1;return a<10&&(a=`0${a}`),s<10&&(s=`0${s}`),`${a}.${s}.${t.getFullYear()}`};class MyCustomSelect{constructor(e,t){this.$el=document.getElementById(e),this.data=t,this.mapPlaceholder=new Map,this.#e(),this.#a()}#e(){this.#d(),this.$el.querySelector(".select__body").innerHTML=selectTemplate(this.data),this.$el.querySelector(".card__input").innerHTML=`${this.#c()}`}#a(){this.$el.addEventListener("click",(e=>{if(e.target.closest(this.data.class))return this.$el.querySelector(".select__body").classList.toggle("show"),void this.$el.querySelector(this.data.class).classList.toggle("show");if(e.target.classList.contains("quantity__btn")){const t=e.target.closest(".quantity"),a=t.dataset.index,s=this.data.options[a];let l,i=!1;e.target.classList.contains("quantity__minus")&&s.value>0&&(l=this.mapPlaceholder.get(s.placeholdername),this.data.options[a].value--,l.value--,i=!0),e.target.classList.contains("quantity__plus")&&this.data.options[a].value<this.data.options[a].maxvalue&&(l=this.mapPlaceholder.get(s.placeholdername),this.data.options[a].value++,l.value++,i=!0),i&&(t.querySelector(".quantity__value").innerHTML=`${this.data.options[a].value}`,this.mapPlaceholder.set(s.placeholdername,l),this.$el.querySelector(".card__input").innerHTML=`${this.#c()}`)}e.target.closest(".done")&&(this.$el.querySelector(".select__body").classList.remove("show"),this.$el.querySelector(".card__input").classList.remove("show")),e.target.closest(".clear")&&(this.data.options.forEach((e=>{e.value=0})),this.#t())}))}#c(){let e=[];for(let t of this.mapPlaceholder.keys())if(this.mapPlaceholder.get(t).value>0){let a=this.mapPlaceholder.get(t).value,s=termOfNum(this.mapPlaceholder.get(t).value,this.mapPlaceholder.get(t).tails);e.push(`${a} ${s}`)}else;return 0==e.length?this.data.placeholder:e.join(", ")}#d(){this.data.options.forEach((e=>{this.mapPlaceholder.has(e.placeholdername)?this.mapPlaceholder.set(e.placeholdername,{value:this.mapPlaceholder.get(e.placeholdername).value+e.value,tails:e.tails}):this.mapPlaceholder.set(e.placeholdername,{value:+e.value,tails:e.tails})}))}#t(){this.$el.querySelectorAll(".quantity").forEach(((e,t)=>{e.querySelector(".quantity__value").innerHTML=`${this.data.options[t].value}`})),this.mapPlaceholder.clear(),this.#d(),this.$el.querySelector(".card__input").innerHTML=`${this.#c()}`}}const selectTemplate=e=>`\n\t\t${optionsTemplate(e.options)}\n\t\t<div class="select__buttons">\n\t\t\t<div class="select__btn clear">очистить</div>\n\t\t\t<div class="select__btn done">применить</div>\n\t\t</div>\n`,optionsTemplate=(e=[])=>e.map(((e,t)=>`\n\t\t<div class="select__option">\n\t\t\t<div class="select__name">${e.name}</div>\n\t\t\t<div class="select__quantity quantity" data-index=${t}>\n\t\t\t\t<div class="quantity__btn quantity__minus"></div>\n\t\t\t\t<div class="quantity__value">${e.value}</div>\n\t\t\t\t<div class="quantity__btn quantity__plus"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t`)).join(""),termOfNum=(e,t)=>(cases=[2,0,1,1,1,2],t[e%100>4&&e%100<20?2:cases[e%10<5?e%10:5]]);if(document.addEventListener("click",(e=>{e.target.closest(".tab__btn")&&(console.log(e.target.closest(".tab").querySelector(".tab__body")),e.target.closest(".tab").querySelector(".tab__body").classList.toggle("show"))})),document.getElementById("guests")){new MyCustomSelect("guests",{placeholder:"Сколько гостей",class:".card__input",options:[{name:"взрослыe",value:0,maxvalue:7,placeholdername:"гость",tails:["гость","гостя","гостей"]},{name:"дети",value:0,maxvalue:7,placeholdername:"гость",tails:["гость","гостя","гостей"]},{name:"младенцы",value:0,maxvalue:7,placeholdername:"младенец",tails:["младенец","младенца","младенцев"]}]})}if(document.getElementById("comfort")){new MyCustomSelect("comfort",{placeholder:"удобства номера",class:".card__input",options:[{name:"спальни",value:2,maxvalue:3,placeholdername:"спальни",tails:["спальня","спальни","спален"]},{name:"кровати",value:2,maxvalue:4,placeholdername:"кровати",tails:["кровать","кровати","кроватей"]},{name:"ванные комнаты",value:0,maxvalue:2,placeholdername:"ванные комнаты",tails:["ванная комната","ванные комнаты","ванных комнат"]}]})}if(document.querySelector(".calendar")){new Calendar(".calendar",{placeholder:"ДД.ММ.ГГГГ",class:".card__input"})}